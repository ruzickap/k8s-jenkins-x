(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{301:function(e,n,t){e.exports=t.p+"assets/img/sock_shop-staging.d9d843e4.png"},302:function(e,n,t){e.exports=t.p+"assets/img/prow_status.ae7deeab.png"},303:function(e,n,t){e.exports=t.p+"assets/img/tekton_dashboard.e9917832.png"},317:function(e,n,t){"use strict";t.r(n);var a=t(8),s=Object(a.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"sock-shop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sock-shop"}},[e._v("#")]),e._v(" Sock Shop")]),e._v(" "),n("p",[e._v("Sock Shop Architecture:")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://raw.githubusercontent.com/microservices-demo/microservices-demo.github.io/40d8170161d2f81cc6524f8aa137c8e9f9131ecd/assets/Architecture.png",alt:"Sock Shop Architecture",title:"Sock Shop Architecture"}})]),e._v(" "),n("p",[e._v("Open the Jenkins X Prow:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("firefox https://deck.jx.mylabs.dev "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v("\n")])])]),n("p",[e._v("Deploy the Sock Shop microservices to the "),n("code",[e._v("jx-production")]),e._v(" and "),n("code",[e._v("jx-staging")]),e._v(".\nOnly the "),n("code",[e._v("front-end")]),e._v(" microservice will be modified and handled by Jenkins X.\nThe rest of microservices will be installed form default Sock Shop\nk8s manifests.\nModifications can be seen here: "),n("a",{attrs:{href:"https://github.com/ruzickap/k8s-jenkins-x/blob/master/files/complete-demo.yaml",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/ruzickap/k8s-jenkins-x/blob/master/files/complete-demo.yaml"),n("OutboundLink")],1)]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s/namespace: sock-shop/namespace: jx-production/"')]),e._v(" files/complete-demo.yaml "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" kubectl apply "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" -\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s/namespace: sock-shop/namespace: jx-staging/"')]),e._v("    files/complete-demo.yaml "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" kubectl apply "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" -\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("deployment.extensions/carts-db created\nservice/carts-db created\ndeployment.extensions/carts created\nservice/carts created\ndeployment.extensions/catalogue-db created\nservice/catalogue-db created\ndeployment.extensions/catalogue created\nservice/catalogue created\ndeployment.extensions/orders-db created\nservice/orders-db created\ndeployment.extensions/orders created\nservice/orders created\ndeployment.extensions/payment created\nservice/payment created\ndeployment.extensions/queue-master created\nservice/queue-master created\ndeployment.extensions/rabbitmq created\nservice/rabbitmq created\ndeployment.extensions/shipping created\nservice/shipping created\ndeployment.extensions/user-db created\nservice/user-db created\ndeployment.extensions/user created\nservice/user created\ndeployment.extensions/carts-db created\nservice/carts-db created\ndeployment.extensions/carts created\nservice/carts created\ndeployment.extensions/catalogue-db created\nservice/catalogue-db created\ndeployment.extensions/catalogue created\nservice/catalogue created\ndeployment.extensions/orders-db created\nservice/orders-db created\ndeployment.extensions/orders created\nservice/orders created\ndeployment.extensions/payment created\nservice/payment created\ndeployment.extensions/queue-master created\nservice/queue-master created\ndeployment.extensions/rabbitmq created\nservice/rabbitmq created\ndeployment.extensions/shipping created\nservice/shipping created\ndeployment.extensions/user-db created\nservice/user-db created\ndeployment.extensions/user created\nservice/user created\n")])])]),n("p",[e._v('Fork the "Sock Shop" repository '),n("code",[e._v("front-end")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" tmp\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" tmp\nhub clone "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"microservices-demo/front-end"')]),e._v("\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Cloning into 'front-end'...\nremote: Enumerating objects: 1156, done.\nremote: Total 1156 (delta 0), reused 0 (delta 0), pack-reused 1156\nReceiving objects: 100% (1156/1156), 47.86 MiB | 8.27 MiB/s, done.\nResolving deltas: 100% (642/642), done.\n")])])]),n("p",[e._v("The "),n("code",[e._v("jx import")]),e._v(" command expects, that the "),n("code",[e._v("Dockerfile")]),e._v(" will expose single port "),n("code",[e._v("8080")]),e._v(".\nTherefore I need to change this in "),n("code",[e._v("front-end")]),e._v(" Docker file to be able to work\nwith "),n("code",[e._v("jx import")]),e._v(" smoothly:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'s/8079/8080/'")]),e._v(" front-end/Dockerfile\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-C")]),e._v(" front-end "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" Dockerfile\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-C")]),e._v(" front-end commit "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-m")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Port in Dockerfile changed from 8079 to 8080"')]),e._v("\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("[master b7f3b45] Port in Dockerfile changed from 8079 to 8080\n 1 file changed, 2 insertions(+), 2 deletions(-)\n")])])]),n("p",[e._v("Fork the repository and push the changes there:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("hub "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-C")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"front-end"')]),e._v(" fork\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-C")]),e._v(" front-end push ruzickap\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("rm")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-rf")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"front-end"')]),e._v("\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Updating ruzickap\nFrom https://github.com/microservices-demo/front-end\n * [new branch]      abuehrle-patch-2                 -> ruzickap/abuehrle-patch-2\n * [new branch]      add-localserver-option           -> ruzickap/add-localserver-option\n * [new branch]      add-weave-imgs                   -> ruzickap/add-weave-imgs\n * [new branch]      add-zipkin                       -> ruzickap/add-zipkin\n * [new branch]      add_zipkin2                      -> ruzickap/add_zipkin2\n * [new branch]      adduser                          -> ruzickap/adduser\n * [new branch]      cpu_usage                        -> ruzickap/cpu_usage\n * [new branch]      deals-integration                -> ruzickap/deals-integration\n * [new branch]      documentation/commands           -> ruzickap/documentation/commands\n * [new branch]      enhancement/brander              -> ruzickap/enhancement/brander\n * [new branch]      enhancement/opentracing-frontend -> ruzickap/enhancement/opentracing-frontend\n * [new branch]      fix-42                           -> ruzickap/fix-42\n * [new branch]      hackathon-fixed                  -> ruzickap/hackathon-fixed\n * [new branch]      master                           -> ruzickap/master\n * [new branch]      remove-metric-cardinality        -> ruzickap/remove-metric-cardinality\nnew remote: ruzickap\nWarning: Permanently added '[ssh.github.com]:443,[192.30.253.123]:443' (RSA) to the list of known hosts.\nEnumerating objects: 5, done.\nCounting objects: 100% (5/5), done.\nDelta compression using up to 4 threads\nCompressing objects: 100% (3/3), done.\nWriting objects: 100% (3/3), 332 bytes | 332.00 KiB/s, done.\nTotal 3 (delta 2), reused 0 (delta 0)\nremote: Resolving deltas: 100% (2/2), completed with 2 local objects.\nTo github.com:ruzickap/front-end.git\n   b6604d9..b7f3b45  master -> master\n")])])]),n("p",[e._v("You can see the code in: "),n("a",{attrs:{href:"https://github.com/ruzickap/front-end",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/ruzickap/front-end"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Import application into Jenkins X:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("jx "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("import")]),e._v(" --git-username"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("ruzickap "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"front-end"')]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--url")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://github.com/ruzickap/front-end"')]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v("\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('Using Git user name: ruzickap\nperforming pack detection in folder /home/pruzicka/git/k8s-jenkins-x/tmp/front-end\n--\x3e Draft detected Coq (51.985930%)\n--\x3e Could not find a pack for Coq. Trying to find the next likely language match...\n--\x3e Draft detected SVG (16.817856%)\n--\x3e Could not find a pack for SVG. Trying to find the next likely language match...\n--\x3e Draft detected HTML (16.808026%)\n--\x3e Could not find a pack for HTML. Trying to find the next likely language match...\n--\x3e Draft detected JavaScript (9.282228%)\nselected pack: /home/pruzicka/.jx/draft/packs/github.com/jenkins-x-buildpacks/jenkins-x-kubernetes/packs/javascript\nreplacing placeholders in directory /home/pruzicka/git/k8s-jenkins-x/tmp/front-end\napp name: front-end, git server: github.com, org: ruzickap, Docker registry org: ruzickap\nskipping directory "/home/pruzicka/git/k8s-jenkins-x/tmp/front-end/.git"\nLet\'s ensure that we have an ECR repository for the Docker image ruzickap/front-end\nCreating GitHub webhook for ruzickap/front-end for url http://hook.jx.mylabs.dev/hook\n\nWatch pipeline activity via:    jx get activity -f front-end -w\nBrowse the pipeline log via:    jx get build logs ruzickap/front-end/master\nYou can list the pipelines via: jx get pipelines\nWhen the pipeline is complete:  jx get applications\n\nFor more help on available commands see: https://jenkins-x.io/developing/browsing/\n\nNote that your first pipeline may take a few minutes to start while the necessary images get downloaded!\n')])])]),n("p",[e._v("Browse the pipeline log via:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("jx get build logs "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--wait")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true ruzickap/front-end/master\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('The selected pipeline didn\'t start, let\'s wait a bit\nBuild logs for ruzickap/front-end/master #1\n\nwaiting for stage meta-pipeline : container step-credential-initializer-mxv7z to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage meta-pipeline and container step-credential-initializer-mxv7z\n{"level":"warn","ts":1571326350.6521983,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \\"ref: refs/heads/master\\" is not a valid GitHub commit ID"}\n{"level":"info","ts":1571326350.6530662,"logger":"fallback-logger","caller":"creds-init/main.go:40","msg":"Credentials initialized."}\n\nwaiting for stage meta-pipeline : container step-working-dir-initializer-jvx69 to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage meta-pipeline and container step-working-dir-initializer-jvx69\n{"level":"warn","ts":1571326353.7272487,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: open /var/run/ko/HEAD: no such file or directory"}\n{"level":"info","ts":1571326353.7283375,"logger":"fallback-logger","caller":"bash/main.go:65","msg":"Successfully executed command \\"mkdir -p /workspace/source\\""}\n\nwaiting for stage meta-pipeline : container step-place-tools to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage meta-pipeline and container step-place-tools\n\nwaiting for stage meta-pipeline : container step-git-source-meta-ruzickap-front-end-master-hxhmf to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage meta-pipeline and container step-git-source-meta-ruzickap-front-end-master-hxhmf\n{"level":"warn","ts":1571326362.0682209,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \\"ref: refs/heads/master\\" is not a valid GitHub commit ID"}\n{"level":"info","ts":1571326368.849677,"logger":"fallback-logger","caller":"git/git.go:102","msg":"Successfully cloned https://github.com/ruzickap/front-end.git @ bc24537484dfa7aed349edf20f63034e3d4f72f6 in path /workspace/source"}\n\nwaiting for stage meta-pipeline : container step-git-merge to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage meta-pipeline and container step-git-merge\nUsing SHAs from PULL_REFS=master:bc24537484dfa7aed349edf20f63034e3d4f72f6\nWARNING: no SHAs to merge, falling back to initial cloned commit\n\nwaiting for stage meta-pipeline : container step-merge-pull-refs to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage meta-pipeline and container step-merge-pull-refs\nSKIP merge-pull-refs: Nothing to merge\n\nwaiting for stage meta-pipeline : container step-create-effective-pipeline to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage meta-pipeline and container step-create-effective-pipeline\nDeleting and cloning the Jenkins X versions repo\nCloning the Jenkins X versions repo https://github.com/jenkins-x/jenkins-x-versions.git with ref refs/heads/master to /builder/home/.jx/jenkins-x-versions\nEffective pipeline written to jenkins-x-effective.yml\n\nwaiting for stage meta-pipeline : container step-create-tekton-crds to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage meta-pipeline and container step-create-tekton-crds\nrunning command: echo \\$(jx-release-version) > VERSION\n\nrunning command: jx step tag --version \\$(cat VERSION)\nUpdating chart version in charts/front-end/Chart.yaml to 0.3.13\nUpdating repository in charts/front-end/values.yaml to 822044714040.dkr.ecr.eu-central-1.amazonaws.com/ruzickap/front-end\nUpdating tag in charts/front-end/values.yaml to 0.3.13\nTag v0.3.13 created and pushed to remote origin\n\nWARNING: failed to find secret kaniko-secret in namespace jx: secrets "kaniko-secret" not found\nPipelineActivity for ruzickap-front-end-master-1\nApplying changes\nupserted PipelineResource ruzickap-front-end-master for the git repository https://github.com/ruzickap/front-end.git\nupserted Task ruzickap-front-end-master-from-build-pack-1\nupserted Pipeline ruzickap-front-end-master-1\ncreated PipelineRun ruzickap-front-end-master-1\ncreated PipelineStructure ruzickap-front-end-master-1\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-credential-initializer-r9p2h\n{"level":"warn","ts":1571326394.9351523,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \\"ref: refs/heads/master\\" is not a valid GitHub commit ID"}\n{"level":"info","ts":1571326394.9359286,"logger":"fallback-logger","caller":"creds-init/main.go:40","msg":"Credentials initialized."}\n\nwaiting for stage from-build-pack : container step-working-dir-initializer-x95mf to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-working-dir-initializer-x95mf\n{"level":"warn","ts":1571326397.5499449,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: open /var/run/ko/HEAD: no such file or directory"}\n{"level":"info","ts":1571326397.550805,"logger":"fallback-logger","caller":"bash/main.go:65","msg":"Successfully executed command \\"mkdir -p /workspace/source\\""}\n\nwaiting for stage from-build-pack : container step-place-tools to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-place-tools\n\nwaiting for stage from-build-pack : container step-git-source-ruzickap-front-end-master-5h7d7 to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-git-source-ruzickap-front-end-master-5h7d7\n{"level":"warn","ts":1571326427.4969535,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \\"ref: refs/heads/master\\" is not a valid GitHub commit ID"}\n{"level":"info","ts":1571326430.9216669,"logger":"fallback-logger","caller":"git/git.go:102","msg":"Successfully cloned https://github.com/ruzickap/front-end.git @ v0.3.13 in path /workspace/source"}\n\nwaiting for stage from-build-pack : container step-git-merge to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-git-merge\nUsing SHAs from PULL_REFS=master:bc24537484dfa7aed349edf20f63034e3d4f72f6\nWARNING: no SHAs to merge, falling back to initial cloned commit\n\nwaiting for stage from-build-pack : container step-setup-jx-git-credentials to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-setup-jx-git-credentials\nGenerated Git credentials file /workspace/xdg_config/git/credentials\n\nwaiting for stage from-build-pack : container step-build-npmrc to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-build-npmrc\nWARNING: failed to find Secret npm-token in namespace jx\n\nwaiting for stage from-build-pack : container step-build-npm-install to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-build-npm-install\nnpm WARN deprecated istanbul@0.4.5: This module is no longer maintained, try this instead:\nnpm WARN deprecated   npm i nyc\nnpm WARN deprecated Visit https://istanbul.js.org/integrations for other alternatives.\nnpm WARN deprecated json3@3.3.2: Please use the native JSON object instead of JSON 3\nnpm WARN deprecated formatio@1.1.1: This package is unmaintained. Use @sinonjs/formatio instead\nnpm WARN deprecated superagent@2.3.0: Please note that v5.0.1+ of superagent removes User-Agent header by default, therefore you may need to add it yourself (e.g. GitHub blocks requests without a User-Agent header).  This notice will go away with v5.0.2+ once it is released.\nnpm WARN deprecated samsam@1.1.2: This package has been deprecated in favour of @sinonjs/samsam\nnpm WARN deprecated samsam@1.1.3: This package has been deprecated in favour of @sinonjs/samsam\nnpm notice created a lockfile as package-lock.json. You should commit this file.\nadded 246 packages from 706 contributors and audited 489 packages in 5.614s\nfound 4 vulnerabilities (3 low, 1 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\n\nwaiting for stage from-build-pack : container step-build-npm-test to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-build-npm-test\n\n> microservices-demo-front-end@0.0.1 test /workspace/source\n> istanbul cover node_modules/.bin/_mocha -- test/*_test.js test/api/*_test.js\n\n\n\n  helpers\n    #errorHandler\n      the rendered JSON\n        ✓ includes an error message\n        ✓ includes an error object\n        ✓ returns the right HTTP status code\n      given the error has no status defined\n        ✓ responds with HTTP status code 500\n    #respondSuccessBody\n      ✓ renders the given body with status 200 OK\n    #respondStatusBody\n      ✓ sets the proper status code &amp; body\n    #respondStatus\n      ✓ sets the proper status code\n    #simpleHttpRequest\n      ✓ performs a GET request to the given URL\n      given the external service responds with success\n        ✓ yields the external service response to the response body\n        ✓ responds with success\n      given the external service fails\n        ✓ invokes the given callback with an error object\n    #getCustomerId\n      given the environment is development\n        - returns the customer id from the query string\n      given a customer id set in session\n        - returns the customer id from the session\n      given no customer id set in the cookies\n        given no customer id set session\n          - throws a \'User not logged in\' error\n\n  endpoints\n    catalogueUrl\n      ✓ points to the proper endpoint\n    tagsUrl\n      ✓ points to the proper endpoint\n    cartsUrl\n      ✓ points to the proper endpoint\n    ordersUrl\n      ✓ points to the proper endpoint\n    customersUrl\n      ✓ points to the proper endpoint\n    addressUrl\n      ✓ points to the proper endpoint\n    cardsUrl\n      ✓ points to the proper endpoint\n    loginUrl\n      ✓ points to the proper endpoint\n    registerUrl\n      ✓ points to the proper endpoint\n\n\n  20 passing (69ms)\n  3 pending\n\n=============================================================================\nWriting coverage object [/workspace/source/coverage/coverage.json]\nWriting coverage reports at [/workspace/source/coverage]\n=============================================================================\n\n=============================== Coverage summary ===============================\nStatements   : 65.96% ( 31/47 )\nBranches     : 22.73% ( 5/22 )\nFunctions    : 75% ( 9/12 )\nLines        : 65.22% ( 30/46 )\n================================================================================\n\nwaiting for stage from-build-pack : container step-build-container-build to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-build-container-build\nINFO[0000] Downloading base image node:10-alpine\nINFO[0001] Error while retrieving image from cache: getting file info: stat /workspace/sha256:5cf3bedcacc2b6ae46504c4c165c74ae88b5fb5eb67f9dfcc3b0cca193f366ff: no such file or directory\nINFO[0001] Downloading base image node:10-alpine\nINFO[0002] cmd: EXPOSE\nINFO[0002] Adding exposed port: 8080/tcp\nINFO[0002] Checking for cached layer 822044714040.dkr.ecr.eu-central-1.amazonaws.com/todo/cache:bd87bc6d085113780d96ba07a293b80fe884174ca0eacf65c175e0ba3c4cba94...\nINFO[0002] No cached layer found for cmd RUN addgroup mygroup &amp;&amp; adduser -D -G mygroup myuser &amp;&amp; mkdir -p /usr/src/app &amp;&amp; chown -R myuser /usr/src/app\nINFO[0002] Unpacking rootfs as cmd RUN addgroup mygroup &amp;&amp; adduser -D -G mygroup myuser &amp;&amp; mkdir -p /usr/src/app &amp;&amp; chown -R myuser /usr/src/app requires it.\nINFO[0004] Taking snapshot of full filesystem...\nINFO[0005] ENV NODE_ENV "production"\nINFO[0005] No files changed in this command, skipping snapshotting.\nINFO[0005] ENV PORT 8080\nINFO[0005] No files changed in this command, skipping snapshotting.\nINFO[0005] EXPOSE 8080\nINFO[0005] cmd: EXPOSE\nINFO[0005] Adding exposed port: 8080/tcp\nINFO[0005] No files changed in this command, skipping snapshotting.\nINFO[0005] RUN addgroup mygroup &amp;&amp; adduser -D -G mygroup myuser &amp;&amp; mkdir -p /usr/src/app &amp;&amp; chown -R myuser /usr/src/app\nINFO[0005] cmd: /bin/sh\nINFO[0005] args: [-c addgroup mygroup &amp;&amp; adduser -D -G mygroup myuser &amp;&amp; mkdir -p /usr/src/app &amp;&amp; chown -R myuser /usr/src/app]\nINFO[0005] Taking snapshot of full filesystem...\nINFO[0005] WORKDIR /usr/src/app\nINFO[0005] cmd: workdir\nINFO[0005] Changed working directory to /usr/src/app\nINFO[0005] No files changed in this command, skipping snapshotting.\nINFO[0005] Pushing layer 822044714040.dkr.ecr.eu-central-1.amazonaws.com/todo/cache:bd87bc6d085113780d96ba07a293b80fe884174ca0eacf65c175e0ba3c4cba94 to cache now\nINFO[0005] Using files from context: [/workspace/source/package.json]\nINFO[0005] COPY package.json /usr/src/app/\nINFO[0005] Taking snapshot of files...\nINFO[0005] Using files from context: [/workspace/source/yarn.lock]\nINFO[0005] COPY yarn.lock /usr/src/app/\nINFO[0005] Taking snapshot of files...\nINFO[0005] RUN chown myuser /usr/src/app/yarn.lock\nINFO[0005] cmd: /bin/sh\nINFO[0005] args: [-c chown myuser /usr/src/app/yarn.lock]\nINFO[0005] Taking snapshot of full filesystem...\nINFO[0006] USER myuser\nINFO[0006] cmd: USER\nINFO[0006] No files changed in this command, skipping snapshotting.\nINFO[0006] RUN yarn install\nINFO[0006] cmd: /bin/sh\nINFO[0006] args: [-c yarn install]\nINFO[0006] Pushing layer 822044714040.dkr.ecr.eu-central-1.amazonaws.com/todo/cache:8d57e812fc750aa16ea221c05ce0f66849985b956fbcd185393e5845859caf77 to cache now\nyarn install v1.17.3\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nsuccess Saved lockfile.\nDone in 3.39s.\nINFO[0010] Taking snapshot of full filesystem...\nINFO[0012] Pushing layer 822044714040.dkr.ecr.eu-central-1.amazonaws.com/todo/cache:65687f541e775add659f8825098e577c070b7aae5b46536acdb2e2e777c52970 to cache now\nINFO[0012] Using files from context: [/workspace/source]\nINFO[0013] COPY . /usr/src/app\nINFO[0013] Taking snapshot of files...\nINFO[0016] CMD ["/usr/local/bin/npm", "start"]\nINFO[0016] No files changed in this command, skipping snapshotting.\nWARN[0016] error uploading layer to cache: failed to push to destination 822044714040.dkr.ecr.eu-central-1.amazonaws.com/todo/cache:bd87bc6d085113780d96ba07a293b80fe884174ca0eacf65c175e0ba3c4cba94: NAME_UNKNOWN: The repository with name \'todo/cache\' does not exist in the registry with id \'822044714040\'\n2019/10/17 15:34:17 existing blob: sha256:50958466d97a8d1ceedc4e851de4fc43e3e3e0618e548597f63f0b546cb8797c\n2019/10/17 15:34:17 existing blob: sha256:56174ae7ed1d5c96ca66882e205154d7067a1a8a325bd8fdec6d5f933f66e0a3\n2019/10/17 15:34:17 existing blob: sha256:284842a36c0d8eea230cfd5e7a4a6b450fcd63d1c4737f236a91e1671455050a\n2019/10/17 15:34:17 existing blob: sha256:e7c96db7181be991f19a9fb6975cdbbd73c65f4a2681348e63a141a2192a5f10\n2019/10/17 15:34:17 pushed blob: sha256:9163581487edf11423ffc421fda77d06cf6d0957bffc4300ee240a4bda374b53\n2019/10/17 15:34:17 pushed blob: sha256:5926b01463ec4a87cfba2318b6e4dab94db7175e9a54763a66c3004ac2bce8b1\n2019/10/17 15:34:17 pushed blob: sha256:78d96deb504edacdfa883ba1e73171270e1e6d4973b21838f1962a4bca74e8cf\n2019/10/17 15:34:17 pushed blob: sha256:d8331e67b06655ef960a19dc626c7d20769cd51c8db9aafa4a948f6c6678bf8f\n2019/10/17 15:34:17 pushed blob: sha256:d1f29b270034b2c82ee12c29bc12f56c2dbe8fec63b17f3e04e4f6b6ef807675\n2019/10/17 15:34:21 pushed blob: sha256:a36db1027eba54167d866a6d7e71be248d245f45a30e4126d741fa4ed382f162\n2019/10/17 15:34:30 pushed blob: sha256:f29d7a0aae9b9222ca0bdab5b993a2a9856511981ca9d12bee9d67fab50d528f\n2019/10/17 15:34:30 822044714040.dkr.ecr.eu-central-1.amazonaws.com/ruzickap/front-end:0.3.13: digest: sha256:6a78c378e6f4426eba0eda2ef658a3675b289b68f32b803845444f45a799c913 size: 1893\n\nwaiting for stage from-build-pack : container step-build-post-build to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-build-post-build\nno CVE provider running in the current jx namespace so skip adding image to be analysed\n\nwaiting for stage from-build-pack : container step-promote-changelog to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-promote-changelog\nConverted /workspace/source/charts/front-end to an unshallow repository\nGenerating change log from git ref b2308a3ecc70b9ac97b93ce73985e57d5d0c186b => 96b824f0dfe7fefb5e6300a1aecebe5952dc8bfb\nAssociating user x-0 in users.jenkins.io with email petr.ruzicka@gmail.com to git GitProvider user with login -0 as emails match\nAdding label jenkins.io/git-github-userid=-0 to user x-0 in users.jenkins.io\nWARNING: Failed to enrich commit bc24537484dfa7aed349edf20f63034e3d4f72f6 with issues: User.jenkins.io "x-0" is invalid: metadata.labels: Invalid value: "-0": a valid label must be an empty string or consist of alphanumeric characters, \'-\', \'_\' or \'.\', and must start and end with an alphanumeric character (e.g. \'MyValue\',  or \'my_value\',  or \'12345\', regex used for validation is \'(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?\')\nFinding issues in commit messages using git format\nAssociating user x-0 in users.jenkins.io with email petr.ruzicka@gmail.com to git GitProvider user with login -0 as emails match\nAdding label jenkins.io/git-github-userid=-0 to user x-0 in users.jenkins.io\nWARNING: Failed to enrich commit b7f3b45438e3c21a1df16fd6f4bd8d4fb2935dea with issues: User.jenkins.io "x-0" is invalid: metadata.labels: Invalid value: "-0": a valid label must be an empty string or consist of alphanumeric characters, \'-\', \'_\' or \'.\', and must start and end with an alphanumeric character (e.g. \'MyValue\',  or \'my_value\',  or \'12345\', regex used for validation is \'(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?\')\nAssociating user x-0 in users.jenkins.io with email petr.ruzicka@gmail.com to git GitProvider user with login -0 as emails match\nAdding label jenkins.io/git-github-userid=-0 to user x-0 in users.jenkins.io\nWARNING: Failed to enrich commit b7f3b45438e3c21a1df16fd6f4bd8d4fb2935dea with issues: User.jenkins.io "x-0" is invalid: metadata.labels: Invalid value: "-0": a valid label must be an empty string or consist of alphanumeric characters, \'-\', \'_\' or \'.\', and must start and end with an alphanumeric character (e.g. \'MyValue\',  or \'my_value\',  or \'12345\', regex used for validation is \'(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?\')\nWARNING: Failed to enrich commit a73c693b4b4d4eb2cfc6d4d386a69d29648fc59c with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit a73c693b4b4d4eb2cfc6d4d386a69d29648fc59c with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit b1ff2c3b4b1af9fdee85320a8ce7b4af39e3c582 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit b1ff2c3b4b1af9fdee85320a8ce7b4af39e3c582 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 8fc609241f33c15531d6997155a5ad25974d841b with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 8fc609241f33c15531d6997155a5ad25974d841b with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 61d1fdf3ed96a7172e0a2cbaf136d158784f09c0 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 61d1fdf3ed96a7172e0a2cbaf136d158784f09c0 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit f7775f5882f39b0e3c579d880311f4020a4d97fd with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit f7775f5882f39b0e3c579d880311f4020a4d97fd with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 82ebb7c9a018063aaeff91eeebdd9e8e4d810519 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 82ebb7c9a018063aaeff91eeebdd9e8e4d810519 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit c3eebf2763bdd9a1e0cc5a0f2a9f402ed8c269aa with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit c3eebf2763bdd9a1e0cc5a0f2a9f402ed8c269aa with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 390c3fd9ecd95db19eb1044d83161e3d4e261219 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 390c3fd9ecd95db19eb1044d83161e3d4e261219 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 7bc6120079b3d403d75a0bfc2248441e94bcdf4f with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 7bc6120079b3d403d75a0bfc2248441e94bcdf4f with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 5adfac298a9d65061b86eba813cab4f151132ae7 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit 5adfac298a9d65061b86eba813cab4f151132ae7 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit d2803dc6f6f46aa34494640b45b8b600d5fbef57 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit d2803dc6f6f46aa34494640b45b8b600d5fbef57 with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit e0ed7795e74370b90a3f57da641f25764966768f with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit e0ed7795e74370b90a3f57da641f25764966768f with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit cd028e31f06a245fe641fb138c8e91165e80ccbb with issues: users.jenkins.io "x-0" already exists\nWARNING: Failed to enrich commit cd028e31f06a245fe641fb138c8e91165e80ccbb with issues: users.jenkins.io "x-0" already exists\nWARNING: No release found for ruzickap/front-end and tag v0.3.13 so creating a new release\nUpdated the release information at https://github.com/ruzickap/front-end/releases/tag/v0.3.13\ngenerated: /workspace/source/charts/front-end/templates/release.yaml\nCreated Release front-end-0-3-13 resource in namespace jx\nUpdating PipelineActivity ruzickap-front-end-master-1 with version 0.3.13\nUpdated PipelineActivities ruzickap-front-end-master-1 with release notes URL: https://github.com/ruzickap/front-end/releases/tag/v0.3.13\n\nwaiting for stage from-build-pack : container step-promote-helm-release to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-promote-helm-release\nWARNING: No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080\nAdding missing Helm repo: storage.googleapis.com https://storage.googleapis.com/chartmuseum.jenkins-x.io\nSuccessfully added Helm repository storage.googleapis.com.\nAdding missing Helm repo: jenkins-x-chartmuseum http://jenkins-x-chartmuseum:8080\nSuccessfully added Helm repository jenkins-x-chartmuseum.\nWARNING: No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080\nUploading chart file front-end-0.3.13.tgz to http://jenkins-x-chartmuseum:8080/api/charts\nReceived 201 response: {"saved":true}\n\nwaiting for stage from-build-pack : container step-promote-jx-promote to start...\n\n\nShowing logs for build ruzickap/front-end/master #1 stage from-build-pack and container step-promote-jx-promote\nWARNING: prow based install so skip waiting for the merge of Pull Requests to go green as currently there is an issue with gettingstatuses from the PR, see https://github.com/jenkins-x/jx/issues/2410\nPromoting app front-end version 0.3.13 to namespace jx-staging\nCreated Pull Request: https://github.com/ruzickap/environment-mylabs-staging/pull/1\nPull Request https://github.com/ruzickap/environment-mylabs-staging/pull/1 is merged at sha 46b4b8c22d3f1e1271170c96598c90f3a247f45c\nPull Request merged but we are not waiting for the update pipeline to complete!\nWARNING: Could not find the service URL in namespace jx-staging for names front-end, jx-front-end, jx-staging-front-end\n')])])]),n("p",[e._v("You should be able to see created container image in AWS ECR: "),n("a",{attrs:{href:"https://eu-central-1.console.aws.amazon.com/ecr/repositories?region=eu-central-1",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://eu-central-1.console.aws.amazon.com/ecr/repositories?region=eu-central-1"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Watch pipeline activity via:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("jx get activity "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" front-end\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sleep")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("60")]),e._v("\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("STEP                                                STARTED AGO DURATION STATUS\nruzickap/front-end/master #1                              3m53s          Succeeded Version: 0.3.13\n  meta pipeline                                           3m53s      41s Succeeded\n    Credential Initializer Mxv7z                          3m53s       0s Succeeded\n    Working Dir Initializer Jvx69                         3m53s       3s Succeeded\n    Place Tools                                           3m50s       3s Succeeded\n    Git Source Meta Ruzickap Front End Master Hxhmf       3m47s      12s Succeeded https://github.com/ruzickap/front-end.git\n    Git Merge                                             3m35s       3s Succeeded\n    Merge Pull Refs                                       3m32s       1s Succeeded\n    Create Effective Pipeline                             3m31s       9s Succeeded\n    Create Tekton Crds                                    3m22s      10s Succeeded\n  from build pack                                          3m9s          Running\n    Credential Initializer R9p2h                           3m9s       0s Succeeded\n    Working Dir Initializer X95mf                          3m9s       3s Succeeded\n    Place Tools                                            3m6s       2s Succeeded\n    Git Source Ruzickap Front End Master 5h7d7             3m4s      31s Succeeded https://github.com/ruzickap/front-end.git\n    Git Merge                                             2m33s       2s Succeeded\n    Setup Jx Git Credentials                              2m31s       0s Succeeded\n    Build Npmrc                                           2m31s       0s Succeeded\n    Build Npm Install                                     2m31s       7s Succeeded\n    Build Npm Test                                        2m24s       1s Succeeded\n    Build Container Build                                 2m23s      30s Succeeded\n    Build Post Build                                      1m53s       1s Succeeded\n    Promote Changelog                                     1m52s      28s Succeeded\n    Promote Helm Release                                  1m24s       4s Succeeded\n    Promote Jx Promote                                    1m20s          Running\n  Promote: staging                                        1m12s     1m6s Succeeded\n    PullRequest                                           1m12s     1m6s Succeeded  PullRequest: https://github.com/ruzickap/environment-mylabs-staging/pull/1 Merge SHA: 46b4b8c22d3f1e1271170c96598c90f3a247f45c\n    Update                                                   6s       0s Succeeded\n")])])]),n("p",[e._v("Check the applications:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("jx get applications\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("APPLICATION  STAGING PODS URL                                    PRODUCTION PODS URL\ncarts                1/1                                                    1/1\ncarts-db             1/1                                                    1/1\ncatalogue            1/1                                                    1/1\ncatalogue-db         1/1                                                    1/1\nfront-end    0.3.13  1/1  http://front-end.jx-staging.mylabs.dev 0.3.13     1/1\norders               1/1                                                    1/1\norders-db            1/1                                                    1/1\npayment              1/1                                                    1/1\nqueue-master         1/1                                                    1/1\nrabbitmq             1/1                                                    1/1\nshipping             1/1                                                    1/1\nuser                 1/1                                                    1/1\nuser-db              1/1                                                    1/1\n")])])]),n("p",[e._v("Verify the URLs:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("jx get urls "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" jx-staging\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("NAME      URL\nfront-end http://front-end.jx-staging.mylabs.dev\n")])])]),n("p",[e._v("The application was only deployed on the staging environment "),n("a",{attrs:{href:"http://front-end.jx-staging.mylabs.dev/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://front-end.jx-staging.mylabs.dev/"),n("OutboundLink")],1),e._v("\nand now it is time to promote it to production:")]),e._v(" "),n("p",[n("img",{attrs:{src:t(301),alt:"Sock Shop - staging",title:"Sock Shop - staging"}})]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("jx promote front-end "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--build")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1"')]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--version")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.3")]),e._v(".13 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--env")]),e._v(" production --batch-mode"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("WARNING: prow based install so skip waiting for the merge of Pull Requests to go green as currently there is an issue with gettingstatuses from the PR, see https://github.com/jenkins-x/jx/issues/2410\nPromoting app front-end version 0.3.13 to namespace jx-production\nCreated Pull Request: https://github.com/ruzickap/environment-mylabs-production/pull/1\nWARNING: failed to parse git provider URL git@github.com:ruzickap/k8s-jenkins-x.git: parse git@github.com:ruzickap/k8s-jenkins-x.git: first path segment in URL cannot contain colon\nPull Request https://github.com/ruzickap/environment-mylabs-production/pull/1 is merged at sha ab7ff64339b03362a8a6a064258ba61ba8ccc120\nPull Request merged but we are not waiting for the update pipeline to complete!\nWARNING: Could not find the service URL in namespace jx-production for names front-end, jx-production-front-end, jx-production-front-end\n")])])]),n("p",[e._v("The promotion to production should be completed soon:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("jx get activity\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sleep")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("60")]),e._v("\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("STEP                                                 STARTED AGO DURATION STATUS\nruzickap/environment-mylabs-production/master #1             14s          Running\n  meta pipeline                                              14s          Running\n    Credential Initializer Gm5lq                             14s       0s Succeeded\n    Working Dir Initializer 6zjqx                            14s       0s Succeeded\n    Place Tools                                              14s       1s Succeeded\n    Git Source Meta Ruzickap Environment Mylab Lx5fq         13s          Running https://github.com/ruzickap/environment-mylabs-production.git\n    Git Merge                                                             Pending\n    Merge Pull Refs                                                       Pending\n    Create Effective Pipeline                                             Pending\n    Create Tekton Crds                                                    Pending\nruzickap/environment-mylabs-production/PR-1 #1               43s          Running\n  meta pipeline                                              43s      16s Succeeded\n    Credential Initializer Dj45d                             43s       0s Succeeded\n    Working Dir Initializer Xb56p                            43s       0s Succeeded\n    Place Tools                                              43s       1s Succeeded\n    Git Source Meta Ruzickap Environment Mylab R7dcd         42s       5s Succeeded https://github.com/ruzickap/environment-mylabs-production.git\n    Git Merge                                                37s       2s Succeeded\n    Merge Pull Refs                                          35s       2s Succeeded\n    Create Effective Pipeline                                33s       5s Succeeded\n    Create Tekton Crds                                       28s       1s Succeeded\n  from build pack                                            23s          Running\n    Credential Initializer H6t5f                             23s       0s Succeeded\n    Working Dir Initializer 9765x                            23s       0s Succeeded\n    Place Tools                                              23s       1s Succeeded\n    Git Source Ruzickap Environment Mylabs Pro D9dnj         22s       6s Succeeded https://github.com/ruzickap/environment-mylabs-production.git\n    Git Merge                                                16s       4s Succeeded\n    Build Helm Build                                         12s          Running\nruzickap/environment-mylabs-staging/master #1              1m21s          Running\n  meta pipeline                                            1m21s      18s Succeeded\n    Credential Initializer L7wk6                           1m21s       0s Succeeded\n    Working Dir Initializer Kjt4g                          1m21s       0s Succeeded\n    Place Tools                                            1m21s       1s Succeeded\n    Git Source Meta Ruzickap Environment Mylab Jgfj9       1m20s       5s Succeeded https://github.com/ruzickap/environment-mylabs-staging.git\n    Git Merge                                              1m15s       1s Succeeded\n    Merge Pull Refs                                        1m14s       0s Succeeded\n    Create Effective Pipeline                              1m14s       5s Succeeded\n    Create Tekton Crds                                      1m9s       6s Succeeded\n  from build pack                                           1m2s          Running\n    Credential Initializer Ml2z7                            1m2s       0s Succeeded\n    Working Dir Initializer 9w6zf                           1m2s       1s Succeeded\n    Place Tools                                             1m1s       1s Succeeded\n    Git Source Ruzickap Environment Mylabs Sta V96rm        1m0s       7s Succeeded https://github.com/ruzickap/environment-mylabs-staging.git\n    Git Merge                                                53s       1s Succeeded\n    Setup Jx Git Credentials                                 52s       1s Succeeded\n    Build Helm Apply                                         51s          Running\nruzickap/environment-mylabs-staging/PR-1 #1                 2m7s    1m31s Succeeded\n  meta pipeline                                             2m7s      19s Succeeded\n    Credential Initializer Pxxn6                            2m7s       0s Succeeded\n    Working Dir Initializer K8s7w                           2m7s       1s Succeeded\n    Place Tools                                             2m6s       1s Succeeded\n    Git Source Meta Ruzickap Environment Mylab Xnsv9        2m5s       6s Succeeded https://github.com/ruzickap/environment-mylabs-staging.git\n    Git Merge                                              1m59s       2s Succeeded\n    Merge Pull Refs                                        1m57s       2s Succeeded\n    Create Effective Pipeline                              1m55s       6s Succeeded\n    Create Tekton Crds                                     1m49s       1s Succeeded\n  from build pack                                          1m42s     1m6s Succeeded\n    Credential Initializer Jzqnd                           1m42s       0s Succeeded\n    Working Dir Initializer Cfdx4                          1m42s       2s Succeeded\n    Place Tools                                            1m40s       1s Succeeded\n    Git Source Ruzickap Environment Mylabs Sta Nx9rn       1m39s      28s Succeeded https://github.com/ruzickap/environment-mylabs-staging.git\n    Git Merge                                              1m11s       5s Succeeded\n    Build Helm Build                                        1m6s      30s Succeeded\nruzickap/front-end/master #1                               4m50s    3m47s Succeeded Version: 0.3.13\n  meta pipeline                                            4m50s      41s Succeeded\n    Credential Initializer Mxv7z                           4m50s       0s Succeeded\n    Working Dir Initializer Jvx69                          4m50s       3s Succeeded\n    Place Tools                                            4m47s       3s Succeeded\n    Git Source Meta Ruzickap Front End Master Hxhmf        4m44s      12s Succeeded https://github.com/ruzickap/front-end.git\n    Git Merge                                              4m32s       3s Succeeded\n    Merge Pull Refs                                        4m29s       1s Succeeded\n    Create Effective Pipeline                              4m28s       9s Succeeded\n    Create Tekton Crds                                     4m19s      10s Succeeded\n  from build pack                                           4m6s     3m3s Succeeded\n    Credential Initializer R9p2h                            4m6s       0s Succeeded\n    Working Dir Initializer X95mf                           4m6s       3s Succeeded\n    Place Tools                                             4m3s       2s Succeeded\n    Git Source Ruzickap Front End Master 5h7d7              4m1s      31s Succeeded https://github.com/ruzickap/front-end.git\n    Git Merge                                              3m30s       2s Succeeded\n    Setup Jx Git Credentials                               3m28s       0s Succeeded\n    Build Npmrc                                            3m28s       0s Succeeded\n    Build Npm Install                                      3m28s       7s Succeeded\n    Build Npm Test                                         3m21s       1s Succeeded\n    Build Container Build                                  3m20s      30s Succeeded\n    Build Post Build                                       2m50s       1s Succeeded\n    Promote Changelog                                      2m49s      28s Succeeded\n    Promote Helm Release                                   2m21s       4s Succeeded\n    Promote Jx Promote                                     2m17s    1m14s Succeeded\n  Promote: staging                                          2m9s     1m6s Succeeded\n    PullRequest                                             2m9s     1m6s Succeeded  PullRequest: https://github.com/ruzickap/environment-mylabs-staging/pull/1 Merge SHA: 46b4b8c22d3f1e1271170c96598c90f3a247f45c\n    Update                                                  1m3s       0s Succeeded\nruzickap/k8s-jenkins-x/master #1                                          Running Version: 0.3.13\n  Release                                                  1m46s     1m0s Succeeded\n  Promote: production                                        46s      46s Succeeded\n    PullRequest                                              46s      45s Succeeded  PullRequest: https://github.com/ruzickap/environment-mylabs-production/pull/1 Merge SHA: ab7ff64339b03362a8a6a064258ba61ba8ccc120\n    Update                                                    1s       1s Succeeded\n")])])]),n("p",[e._v("You should be able to see the same Sock Shop instance on this URL: "),n("a",{attrs:{href:"http://front-end.jx-production.mylabs.dev/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://front-end.jx-production.mylabs.dev/"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Check the production URLs:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("jx get urls "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" jx-production\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("NAME      URL\nfront-end http://front-end.jx-production.mylabs.dev\n")])])]),n("p",[e._v("Verify the "),n("code",[e._v("pipelineactivity")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("kubectl get pipelineactivity "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" jx\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("NAME                                              GIT URL                                                         STATUS\nruzickap-environment-mylabs-production-master-1   https://github.com/ruzickap/environment-mylabs-production.git   Running\nruzickap-environment-mylabs-production-pr-1-1     https://github.com/ruzickap/environment-mylabs-production.git   Running\nruzickap-environment-mylabs-staging-master-1      https://github.com/ruzickap/environment-mylabs-staging.git      Succeeded\nruzickap-environment-mylabs-staging-pr-1-1        https://github.com/ruzickap/environment-mylabs-staging.git      Succeeded\nruzickap-front-end-master-1                       https://github.com/ruzickap/front-end.git                       Succeeded\nruzickap-k8s-jenkins-x-master-1                   git@github.com:ruzickap/k8s-jenkins-x.git                       Running\n")])])]),n("p",[e._v("Look at the Tekton's "),n("code",[e._v("pipelineruns")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("kubectl get pipelineruns.tekton.dev "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" jx\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("NAME                                      AGE\nmeta-ruzickap-environment-mylab-1         2m10s\nmeta-ruzickap-environment-mylab-jb9k5-1   46s\nmeta-ruzickap-environment-mylab-rdchv-1   83s\nmeta-ruzickap-environment-mylab-zln5m-1   21s\nmeta-ruzickap-front-end-master-1          5m\nruzickap-environment-mylabs-pro-1         28s\nruzickap-environment-mylabs-sta-1         109s\nruzickap-environment-mylabs-sta-74ttt-1   64s\nruzickap-front-end-master-1               4m10s\n")])])]),n("p",[e._v("Those pods were created by the pipelines during the build process:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("kubectl get pods "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-l")]),e._v(" jenkins.io/pipelineType"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" jx\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("NAME                                                                       READY   STATUS      RESTARTS   AGE\nruzickap-environment-mylabs-pro-1-from-build-pack-lgzxp-pod-fa1dec         1/3     Running     0          26s\nruzickap-environment-mylabs-sta-1-from-build-pack-h4ds4-pod-2ef560         0/3     Completed   0          108s\nruzickap-environment-mylabs-sta-74ttt-1-from-build-pack-s2vbb-pod-f42bb6   0/4     Completed   0          65s\nruzickap-front-end-master-1-from-build-pack-8k8x9-pod-9ef55a               0/11    Completed   0          4m11s\n")])])]),n("p",[e._v("See the labels on one of the pods created during the build process:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("kubectl get pods "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("kubectl get pods "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-l")]),e._v(" jenkins.io/pipelineType"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" jx "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-o")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"jsonpath={.items[0].metadata.name}"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" jx --show-labels\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("NAME                                                                 READY   STATUS    RESTARTS   AGE   LABELS\nruzickap-environment-mylabs-pro-1-from-build-pack-lgzxp-pod-fa1dec   1/3     Running   0          26s   branch=PR-1,build=1,context=promotion-build,created-by-prow=true,jenkins.io/pipelineType=build,jenkins.io/task-stage-name=from-build-pack,owner=ruzickap,prowJobName=e69bad31-f0f3-11e9-b692-7e7c118eea63,repository=environment-mylabs-production,tekton.dev/pipeline=ruzickap-environment-mylabs-pro-1,tekton.dev/pipelineRun=ruzickap-environment-mylabs-pro-1,tekton.dev/pipelineTask=from-build-pack,tekton.dev/task=ruzickap-environment-mylabs-pro-from-build-pack-1,tekton.dev/taskRun=ruzickap-environment-mylabs-pro-1-from-build-pack-lgzxp\n")])])]),n("p",[e._v("List all the pipelines using the "),n("code",[e._v("tkn")]),e._v(" command (default Tekton client):")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("tkn pipeline list "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" jx\n")])])]),n("p",[e._v("Output:")]),e._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("NAME                                      AGE              LAST RUN                                  STARTED          DURATION     STATUS\nmeta-ruzickap-environment-mylab-1         18 minutes ago   meta-ruzickap-environment-mylab-1         18 minutes ago   23 seconds   Succeeded\nmeta-ruzickap-environment-mylab-jb9k5-1   16 minutes ago   meta-ruzickap-environment-mylab-jb9k5-1   16 minutes ago   21 seconds   Succeeded\nmeta-ruzickap-environment-mylab-rdchv-1   17 minutes ago   meta-ruzickap-environment-mylab-rdchv-1   17 minutes ago   22 seconds   Succeeded\nmeta-ruzickap-environment-mylab-zln5m-1   16 minutes ago   meta-ruzickap-environment-mylab-zln5m-1   16 minutes ago   1 minute     Succeeded\nmeta-ruzickap-front-end-master-1          21 minutes ago   meta-ruzickap-front-end-master-1          21 minutes ago   53 seconds   Succeeded\npipeline0                                 21 minutes ago   ---                                       ---              ---          ---\nruzickap-environment-mylabs-pro-1         16 minutes ago   ruzickap-environment-mylabs-pro-1         16 minutes ago   1 minute     Succeeded\nruzickap-environment-mylabs-pro-7r8jr-1   15 minutes ago   ruzickap-environment-mylabs-pro-7r8jr-1   15 minutes ago   47 seconds   Succeeded\nruzickap-environment-mylabs-sta-1         17 minutes ago   ruzickap-environment-mylabs-sta-1         17 minutes ago   1 minute     Succeeded\nruzickap-environment-mylabs-sta-74ttt-1   17 minutes ago   ruzickap-environment-mylabs-sta-74ttt-1   17 minutes ago   57 seconds   Succeeded\nruzickap-front-end-master-1               20 minutes ago   ruzickap-front-end-master-1               20 minutes ago   3 minutes    Succeeded\n")])])]),n("p",[e._v("Screenshot form Prow "),n("a",{attrs:{href:"https://deck.jx.mylabs.dev",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://deck.jx.mylabs.dev"),n("OutboundLink")],1),e._v(":")]),e._v(" "),n("p",[n("img",{attrs:{src:t(302),alt:"Prow status",title:"Prow status"}})]),e._v(" "),n("p",[e._v("You may also see the Tekton Pipelines using Tekton Dashboard "),n("a",{attrs:{href:"https://tekton-dashboard.jx.mylabs.dev",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://tekton-dashboard.jx.mylabs.dev"),n("OutboundLink")],1),e._v(":")]),e._v(" "),n("p",[n("img",{attrs:{src:t(303),alt:"Tekton Dashboard",title:"Tekton Dashboard"}})])])}),[],!1,null,null,null);n.default=s.exports}}]);