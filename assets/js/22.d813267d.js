(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{304:function(t,e,a){t.exports=a.p+"assets/img/PR.29be64eb.png"},305:function(t,e,a){t.exports=a.p+"assets/img/AWS_ECR.e26cc2a8.png"},319:function(t,e,a){"use strict";a.r(e);var s=a(8),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"jenkins-x-operations"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-x-operations"}},[t._v("#")]),t._v(" Jenkins X operations")]),t._v(" "),e("p",[t._v("Let's try to do some modifications in the "),e("code",[t._v("front-end")]),t._v(" application and see how\nthe Jenkins X will react on changes in git repository.")]),t._v(" "),e("h2",{attrs:{id:"pull-request"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pull-request"}},[t._v("#")]),t._v(" Pull Request")]),t._v(" "),e("p",[t._v("Create Pull Request (PR):")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" tmp/front-end\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-b")]),t._v(" my_change\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s/We love socks/We really love socks/"')]),t._v(" public/index.html\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("diff")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-a")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"String changed"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push origin my_change\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('Switched to a new branch \'my_change\'\n─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────\nmodified: public/index.html\n─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────\n@ public/index.html:86 @ _________________________________________________________ --\x3e\n                            &lt;div class="icon">&lt;i class="fa fa-heart">&lt;/i>\n                            &lt;/div>\n\n                            &lt;h3>&lt;a href="#">We love socks!&lt;/a>&lt;/h3>\n                            &lt;h3>&lt;a href="#">We really love socks!&lt;/a>&lt;/h3>\n                            &lt;p>Fun fact: Socks were invented by woolly mammoths\n                                to keep warm. They died out because stupid\n                                humans had to cut their legs off to get their\n[my_change c5ce0d8] String changed\n 1 file changed, 1 insertion(+), 1 deletion(-)\nEnumerating objects: 7, done.\nCounting objects: 100% (7/7), done.\nDelta compression using up to 4 threads\nCompressing objects: 100% (4/4), done.\nWriting objects: 100% (4/4), 383 bytes | 383.00 KiB/s, done.\nTotal 4 (delta 3), reused 0 (delta 0)\nremote: Resolving deltas: 100% (3/3), completed with 3 local objects.\nremote:\nremote: Create a pull request for \'my_change\' on GitHub by visiting:\nremote:      https://github.com/ruzickap/front-end/pull/new/my_change\nremote:\nTo https://github.com/ruzickap/front-end.git\n * [new branch]      my_change -> my_change\n')])])]),e("p",[t._v("Create PR to the "),e("code",[t._v("fron-end")]),t._v(" master")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("hub pull-request "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"My test PR"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-b")]),t._v(" master\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("https://github.com/ruzickap/front-end/pull/1\n")])])]),e("p",[t._v("Check how the PR looks like: "),e("a",{attrs:{href:"https://github.com/ruzickap/front-end/pull/1",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/ruzickap/front-end/pull/1"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("Look at the build logs for this PR:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("jx get build logs "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--wait")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true ruzickap/front-end/pr-1\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("Build logs for ruzickap/front-end/pr-1 #1 serverless-jenkins\n...\nPreview application is now available at: http://front-end.jx-ruzickap-front-end-pr-1.mylabs.dev\n")])])]),e("p",[t._v("New "),e("code",[t._v("pipelinerun")]),t._v(" were created:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("kubectl get pipelinerun "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" front-end-pr\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("meta-ruzickap-front-end-pr-1-se-1         43m\nruzickap-front-end-pr-1-serverl-1         43m\n")])])]),e("p",[t._v('Jenkins X created special namespace for this temporary "front-end" inside PR:')]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("kubectl get all "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--namespace")]),t._v(" jx-ruzickap-front-end-pr-1\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("NAME                                   READY   STATUS    RESTARTS   AGE\npod/preview-preview-774bb76d75-xqwj7   1/1     Running   0          42m\n\nNAME                TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE\nservice/front-end   ClusterIP   100.69.62.155   &lt;none>        80/TCP    42m\n\nNAME                              READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/preview-preview   1/1     1            1           42m\n\nNAME                                         DESIRED   CURRENT   READY   AGE\nreplicaset.apps/preview-preview-774bb76d75   1         1         1       42m\n")])])]),e("p",[t._v("Check the link in the PR web page "),e("a",{attrs:{href:"https://front-end.jx-ruzickap-front-end-pr-1.mylabs.dev/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://front-end.jx-ruzickap-front-end-pr-1.mylabs.dev/"),e("OutboundLink")],1),t._v('\nand you should see the "We really love socks!":')]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-sk")]),t._v(" https://front-end.jx-ruzickap-front-end-pr-1.mylabs.dev/ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"love socks"')]),t._v("\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-html extra-class"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[t._v("                            "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("#"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("We really love socks!"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("Here is the screenshot:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(304),alt:"PR",title:"PR"}})]),t._v(" "),e("h2",{attrs:{id:"merge"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#merge"}},[t._v("#")]),t._v(" Merge")]),t._v(" "),e("p",[t._v("Let's merge the PR to the "),e("code",[t._v("master")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout master\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" merge my_change --no-ff "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Merge pull request #1 from ruzickap"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("Switched to branch 'master'\nYour branch is up to date with 'origin/master'.\nMerge made by the 'recursive' strategy.\n public/index.html | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\nEnumerating objects: 1, done.\nCounting objects: 100% (1/1), done.\nWriting objects: 100% (1/1), 233 bytes | 233.00 KiB/s, done.\nTotal 1 (delta 0), reused 0 (delta 0)\nTo https://github.com/ruzickap/front-end.git\n   6bb2945..d88a84b  master -> master\n")])])]),e("p",[t._v("This will trigger another build:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("jx get build logs "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--wait")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruzickap/front-end/master #2 release"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("Build logs for ruzickap/front-end/master #2 release\n...\nPull Request https://github.com/ruzickap/environment-mylabs-staging/pull/2 is merged at sha cfe0935b9f327923a37d3f46fd9433559e2b3144\nPull Request merged but we are not waiting for the update pipeline to complete!\n")])])]),e("p",[t._v("Check if the staging was changed after successful merge "),e("a",{attrs:{href:"http://front-end.jx-staging.mylabs.dev",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://front-end.jx-staging.mylabs.dev"),e("OutboundLink")],1),t._v('\nand you should see the "We really love socks!".')]),t._v(" "),e("p",[t._v("The production should not be affected by the PR merge.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-sk")]),t._v(" http://front-end.jx-staging.mylabs.dev "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"love socks"')]),t._v("\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-html extra-class"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[t._v("                            "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("#"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("We really love socks!"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("You should see the change by opening "),e("a",{attrs:{href:"http://front-end.jx-staging.mylabs.dev",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://front-end.jx-staging.mylabs.dev"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("jx promote front-end "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--build")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--version")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.3")]),t._v(".14 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--env")]),t._v(" production --batch-mode"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("WARNING: prow based install so skip waiting for the merge of Pull Requests to go green as currently there is an issue with gettingstatuses from the PR, see https://github.com/jenkins-x/jx/issues/2410\nPromoting app front-end version 0.3.14 to namespace jx-production\nCreated Pull Request: https://github.com/ruzickap/environment-mylabs-production/pull/2\nWARNING: failed to parse git provider URL git@github.com:ruzickap/k8s-jenkins-x.git: parse git@github.com:ruzickap/k8s-jenkins-x.git: first path segment in URL cannot contain colon\nPull Request https://github.com/ruzickap/environment-mylabs-production/pull/2 is merged at sha efbb7115c326151b691849561453d57f2e46f4b2\nPull Request merged but we are not waiting for the update pipeline to complete!\n")])])]),e("p",[t._v("The promotion to production should be completed soon:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("jx get activity\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v("\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("...\nruzickap/k8s-jenkins-x/master #1                                          Running Version: 0.3.13\n  Release                                                 13m18s     1m0s Succeeded\n  Promote: production                                     12m18s     1m7s Succeeded\n    PullRequest                                           12m18s     1m7s Succeeded  PullRequest: https://github.com/ruzickap/environment-mylabs-production/pull/1 Merge SHA: b84c82ec3faf8536409aca200c2067281ccdb745\n    Update                                                11m11s       0s Succeeded\nruzickap/k8s-jenkins-x/master #2                                          Running Version: 0.3.14\n  Release                                                  2m27s     1m0s Succeeded\n  Promote: production                                      1m27s     1m7s Succeeded\n    PullRequest                                            1m27s     1m7s Succeeded  PullRequest: https://github.com/ruzickap/environment-mylabs-production/pull/2 Merge SHA: efbb7115c326151b691849561453d57f2e46f4b2\n    Update                                                   20s       0s Succeeded\n    Promoted                                                 20s       0s Succeeded  Application is at: http://front-end.jx-production.mylabs.dev\n")])])]),e("p",[t._v('You should see the "production change" by opening '),e("a",{attrs:{href:"http://front-end.jx-production.mylabs.dev",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://front-end.jx-production.mylabs.dev"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Here is how the AWS ECR looks like at the end:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(305),alt:"AWS ECR",title:"AWS ECR"}})])])}),[],!1,null,null,null);e.default=n.exports}}]);